<!DOCTYPE html>
<html lang="en-us" dir="ltr" itemscope itemtype="http://schema.org/Article">
  <head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Blogue do Caloni - 2 Coelhos</title>
  <meta name="author" content="" />
  <meta name="generator" content="Hugo 0.110.0">
  <meta property="og:title" content="2 Coelhos"/>
  <meta property="og:type"
        content="article"/>
  <meta property="og:url" content="http://www.caloni.com.br/todo-put-original-title-slug/"/>
  <meta property="og:image"
        content="/img/author.jpg"/>
  <meta property="og:description"
        content="Uma montagem impec·vel consegue dar o tom da narrativa do complexo 2 Coelhos. AlÈm de complexo, existem pequenos detalhes da trama que forÁam um pouco a realidade (como a uni„o entre o protagonista e..."/>
  <link href="" rel="feed" type="application/rss+xml"
        title="Blogue do Caloni"/>
  <link rel="stylesheet" type="text/css" href="/css/custom.css"/>
  <link rel="stylesheet" type="text/css" href="/css/jquery-ui.css"/>
  <link rel="stylesheet" type="text/css" href="/css/board-min.css"/>
  <script src="/js/jquery-1.10.2.js"></script>
  <script src="/js/jquery-ui.js"></script>
  <script src="/js/pgnyui.js"></script>
  <script src="/js/pgnviewer.js"></script>
  <script src="/js/list.js"></script>
  <link rel="icon" href="/img/favicon.ico"/>
</head>
<body style="min-height:100vh;display:flex;flex-direction:column">
  <nav class="navbar has-shadow is-white"
        role="navigation" aria-label="main navigation">
  <div class="container">
  <div class="navbar-brand">
  <pre><span style="font-size: 3px; margin: 0; display: block;">
&amp;*/. .*%@@@@@@@@@@@@&amp;/    , &amp;@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@#,*@@@@%,*&amp;@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@./@.(@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@@@@**#./((,*, *./((*,#,&amp;@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@@@@@.#@@%&amp;@@* (@@%&amp;@@/#@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@@@@@,#@@&amp;&amp;@@, (@@&amp;&amp;@@*#@@@@@@@@@@@@@#/,,.         ..,/#&amp;@@@@@@@@@@@@@@@@@@@@@@@
@@@@@&amp;, .//      .//  .%@@@@@@&amp;#.  .,****.,*************,.  .(&amp;@@@@@@@@@@@@@@@@@
@@@*                     ,@/  .**,,,*********,   ,***,   ****    *@@@@@@@@@@@@@@
@#                         ,***      .******       ,***,*****,      *&amp;@@@@@@@@@@
&amp;                           ,**      .******.     .******************  (@@@@@@@@
                             ****..,*************************,    ,***   (@@@@@@
@@@@#,,,,,,,,,,,,,,,,,,,,*********,   ,**************,  .***,      .**. .  %@@@@
@@@@%                   .***,.,****,.,***,     ,****      ***.     ,******, /@@@
@@@@@&amp;.                ,**       *******,       *****,  .******************, *@@
@@@@@@@&amp;,            ,****      .********,.   .*************,  ,*****,    ,** /@
@@@@@@@@@@@@&amp;/ .****,    ************.   ****************************      **. #
@@@@@@@@@@@@@, *****,    ,***********    .******,   ,****.   .*****,***,,***** ,
@@@@@@@@@@@@&amp;..**************,  ,***********************       ,*,    ********..
@@@@@@@@@@@@&amp; ,**.    ,******.  .*******.    .**********,     .**********. .**, 
@@@@@@@@@@@@% ,*       ,***************.      .*****************************,   
@@@@@@@@@@@@@&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;@,(&amp;&amp;&amp;&amp;@,(&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;#*@&amp;&amp;&amp;@*#&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;
@@@@@@@@@@@@@@@@@@@@@@@@@@@@(.#@@@@(.#@@@@@@@@@@@@@@@@@@@@@#**@@@@(.#@@@@@@@@@@@
  </span></pre>
  &nbsp;
  <a class="navbar-item" title="Go to Home" href="/">
    <div class="is-6">Blogue do Caloni</div>
  </a>
  </div>
  </div>
  </nav>
  <div class="container">
  <p class="title">
  <a class="external" href="https://www.caloni.com.br/todo-put-external-link-here">
  Todo Put Post Title Here
  </a>
  </p>
  <div class="content">
<p>Estava eu outro dia programando aquele c√≥digo esperto "para ontem" quando me deparei com uma situa√ß√£o no m√≠nimo inusitada. Ao testar se um caminho recebido era de fato um diret√≥rio me foi retornado pela API um valor diferente de TRUE. E diferente de FALSE!</p>
<p>De acordo com a documenta√ß√£o, o retorno deveria ser TRUE caso o caminho enviado √† fun√ß√£o fosse de fato um diret√≥rio. Caso contr√°rio, o retorno deveria ser FALSE.</p>
<p>Note que existem apenas dois valores poss√≠veis para essa fun√ß√£o. Por√©m, o valor retornado n√£o √© 1, o equivalente ao define TRUE, mas sim 0x10 (16 em hexadecimal). O simples exemplo abaixo deve conseguir reproduzir a situa√ß√£o (Windows XP Service Pack 3):</p>
<p>    Setting environment for using Microsoft Visual Studio 2008 x86 tools.</p>
<p>    </p>
<p>    C:\Tests>copy con IsPathDir.cpp</p>
<p>    #include <shlwapi.h></p>
<p>    #include <windows.h></p>
<p>    #include <stdio.h></p>
<p>    </p>
<p>    #pragma comment(lib, "shlwapi.lib")</p>
<p>    </p>
<p>    int main()</p>
<p>    {</p>
<p>            BOOL isDir = PathIsDirectory("C:\\Tests"); // obs.: diretorio TEM que existir</p>
<p>            printf("Resultado: %d.\n", isDir);</p>
<p>    }^Z</p>
<p>            1 arquivo(s) copiado(s).</p>
<p>    </p>
<p>    C:\Tests>cl IsPathDir.cpp</p>
<p>    Microsoft (R) 32-bit C/C++ Optimizing Compiler Version 15.00.21022.08 for 80x86</p>
<p>    Copyright (C) Microsoft Corporation.  All rights reserved.</p>
<p>    </p>
<p>    IsPathDir.cpp</p>
<p>    Microsoft (R) Incremental Linker Version 9.00.21022.08</p>
<p>    Copyright (C) Microsoft Corporation.  All rights reserved.</p>
<p>    </p>
<p>    /out:IsPathDir.exe</p>
<p>    IsPathDir.obj</p>
<p>    </p>
<p>    C:\Tests>IsPathDir.exe</p>
<p>    Resultado: 16.</p>
<p>Isso quer dizer apenas que o c√≥digo abaixo vai funcionar,</p>
<p>    if( PathIsDirectory(path) ) // legal: qualquer coisa diferente de zero</p>
<p>o c√≥digo abaixo vai funcionar</p>
<p>    if( ! PathIsDirectory(path) ) // legal: se der zero (FALSE), OK</p>
<p>e o c√≥digo abaixo n√£o vai funcionar:</p>
<p>    if( PathIsDirectory(path) == TRUE ) // vixi: TRUE nem sempre √© o resultado</p>
<p>E, pior, o c√≥digo abaixo tamb√©m n√£o vai funcionar!</p>
<p>    if( PathIsDirectory(path) != TRUE ) // aff... √© bom rever os seus conceitos</p>
<p>Pesquisando um pouco descobri uma boa discuss√£o sobre o tema, e inclusive que outras pessoas descobriram o interessante detalhe que para pastas normais o retorno √© 0x10, mas para compartilhamentos o retorno √© 0x1.</p>
<p>#### O bug atr√°s dos documentos</p>
<p>O problema ocorre por causa da maneira que a fun√ß√£o determina se o caminho √© um diret√≥rio ou n√£o. Uma simples vistoria sobre a fun√ß√£o nos revela o detalhe crucial:</p>
<p>    C:\Tests>cl /Zi IsPathDir.cpp</p>
<p>    Microsoft (R) 32-bit C/C++ Optimizing Compiler Version 15.00.21022.08 for 80x86</p>
<p>    Copyright (C) Microsoft Corporation.  All rights reserved.</p>
<p>    </p>
<p>    IsPathDir.cpp</p>
<p>    Microsoft (R) Incremental Linker Version 9.00.21022.08</p>
<p>    Copyright (C) Microsoft Corporation.  All rights reserved.</p>
<p>    </p>
<p>    /out:IsPathDir.exe</p>
<p>    /debug</p>
<p>    IsPathDir.obj</p>
<p>    </p>
<p>    C:\Tests>cdb IsPathDir.exe</p>
<p>    </p>
<p>    Microsoft (R) Windows Debugger Version 6.8.0004.0 X86</p>
<p>    Copyright (c) Microsoft Corporation. All rights reserved.</p>
<p>    </p>
<p>    CommandLine: IsPathDir.exe</p>
<p>    Symbol search path is: SRV*c:\symbols*http://msdl.microsoft.com/download/symbols</p>
<p>    Executable search path is:</p>
<p>    ModLoad: 00400000 00426000   IsPathDir.exe</p>
<p>    ModLoad: 7c900000 7c9b4000   ntdll.dll</p>
<p>    ModLoad: 7c800000 7c8ff000   C:\WINDOWS\system32\kernel32.dll</p>
<p>    ModLoad: 77ea0000 77f16000   C:\WINDOWS\system32\SHLWAPI.dll</p>
<p>    ModLoad: 77f50000 77ffb000   C:\WINDOWS\system32\ADVAPI32.dll</p>
<p>    ModLoad: 77db0000 77e41000   C:\WINDOWS\system32\RPCRT4.dll</p>
<p>    ModLoad: 77e50000 77e97000   C:\WINDOWS\system32\GDI32.dll</p>
<p>    ModLoad: 7e360000 7e3f0000   C:\WINDOWS\system32\USER32.dll</p>
<p>    ModLoad: 77bf0000 77c48000   C:\WINDOWS\system32\msvcrt.dll</p>
<p>    (ea0.de0): Break instruction exception - code 80000003 (first chance)</p>
<p>    eax=00241eb4 ebx=7ffde000 ecx=00000004 edx=00000010 esi=00241f48 edi=00241eb4</p>
<p>    eip=7c901230 esp=0012fb20 ebp=0012fc94 iopl=0         nv up ei pl nz na po nc</p>
<p>    cs=001b  ss=0023  ds=0023  es=0023  fs=003b  gs=0000             efl=00000202</p>
<p>    ntdll!DbgBreakPoint:</p>
<p>    7c901230 cc              int     3</p>
<p>    0:000> g shlwapi!PathIsDirectoryA</p>
<p>    ModLoad: 76360000 7637d000   C:\WINDOWS\system32\IMM32.DLL</p>
<p>    ModLoad: 62e80000 62e89000   C:\WINDOWS\system32\LPK.DLL</p>
<p>    ModLoad: 74d50000 74dbb000   C:\WINDOWS\system32\USP10.dll</p>
<p>    eax=009836e0 ebx=7ffde000 ecx=00000001 edx=00422828 esi=0006f4cc edi=7c911970</p>
<p>    eip=77ee7538 esp=0012ff6c ebp=0012ff78 iopl=0         nv up ei pl zr na pe nc</p>
<p>    cs=001b  ss=0023  ds=0023  es=0023  fs=003b  gs=0000             efl=00000246</p>
<p>    SHLWAPI!PathIsDirectoryA:</p>
<p>    77ee7538 8bff            mov     edi,edi</p>
<p>    0:000> p</p>
<p>    eax=009836e0 ebx=7ffde000 ecx=00000001 edx=00422828 esi=0006f4cc edi=7c911970</p>
<p>    eip=77ee753a esp=0012ff6c ebp=0012ff78 iopl=0         nv up ei pl zr na pe nc</p>
<p>    cs=001b  ss=0023  ds=0023  es=0023  fs=003b  gs=0000             efl=00000246</p>
<p>    SHLWAPI!PathIsDirectoryA+0x2:</p>
<p>    77ee753a 55              push    ebp</p>
<p>    0:000></p>
<p>    eax=009836e0 ebx=7ffde000 ecx=00000001 edx=00422828 esi=0006f4cc edi=7c911970</p>
<p>    eip=77ee753b esp=0012ff68 ebp=0012ff78 iopl=0         nv up ei pl zr na pe nc</p>
<p>    cs=001b  ss=0023  ds=0023  es=0023  fs=003b  gs=0000             efl=00000246</p>
<p>    SHLWAPI!PathIsDirectoryA+0x3:</p>
<p>    77ee753b 8bec            mov     ebp,esp</p>
<p>    0:000></p>
<p>    eax=009836e0 ebx=7ffde000 ecx=00000001 edx=00422828 esi=0006f4cc edi=7c911970</p>
<p>    eip=77ee753d esp=0012ff68 ebp=0012ff68 iopl=0         nv up ei pl zr na pe nc</p>
<p>    cs=001b  ss=0023  ds=0023  es=0023  fs=003b  gs=0000             efl=00000246</p>
<p>    SHLWAPI!PathIsDirectoryA+0x5:</p>
<p>    77ee753d 81ec0c020000    sub     esp,20Ch</p>
<p>    0:000></p>
<p>    eax=009836e0 ebx=7ffde000 ecx=00000001 edx=00422828 esi=0006f4cc edi=7c911970</p>
<p>    eip=77ee7543 esp=0012fd5c ebp=0012ff68 iopl=0         nv up ei pl nz ac pe nc</p>
<p>    cs=001b  ss=0023  ds=0023  es=0023  fs=003b  gs=0000             efl=00000216</p>
<p>    SHLWAPI!PathIsDirectoryA+0xb:</p>
<p>    77ee7543 a180d2f077      mov     eax,dword ptr [SHLWAPI!__security_cookie</p>
<p>    0:000></p>
<p>    eax=00007a43 ebx=7ffde000 ecx=00000001 edx=00422828 esi=0006f4cc edi=7c911970</p>
<p>    eip=77ee7548 esp=0012fd5c ebp=0012ff68 iopl=0         nv up ei pl nz ac pe nc</p>
<p>    cs=001b  ss=0023  ds=0023  es=0023  fs=003b  gs=0000             efl=00000216</p>
<p>    SHLWAPI!PathIsDirectoryA+0x10:</p>
<p>    77ee7548 56              push    esi</p>
<p>    0:000></p>
<p>    eax=00007a43 ebx=7ffde000 ecx=00000001 edx=00422828 esi=0006f4cc edi=7c911970</p>
<p>    eip=77ee7549 esp=0012fd58 ebp=0012ff68 iopl=0         nv up ei pl nz ac pe nc</p>
<p>    cs=001b  ss=0023  ds=0023  es=0023  fs=003b  gs=0000             efl=00000216</p>
<p>    SHLWAPI!PathIsDirectoryA+0x11:</p>
<p>    *** WARNING: Unable to verify checksum for IsPathDir.exe</p>
<p>    77ee7549 8b7508          mov     esi,dword ptr [ebp+8] ss:0023:0012ff70=0041dc5c</p>
<p>    0:000></p>
<p>    eax=00007a43 ebx=7ffde000 ecx=00000001 edx=00422828 esi=0041dc5c edi=7c911970</p>
<p>    eip=77ee754c esp=0012fd58 ebp=0012ff68 iopl=0         nv up ei pl nz ac pe nc</p>
<p>    cs=001b  ss=0023  ds=0023  es=0023  fs=003b  gs=0000             efl=00000216</p>
<p>    SHLWAPI!PathIsDirectoryA+0x14:</p>
<p>    77ee754c 85f6            test    esi,esi</p>
<p>    0:000></p>
<p>    eax=00007a43 ebx=7ffde000 ecx=00000001 edx=00422828 esi=0041dc5c edi=7c911970</p>
<p>    eip=77ee754e esp=0012fd58 ebp=0012ff68 iopl=0         nv up ei pl nz na pe nc</p>
<p>    cs=001b  ss=0023  ds=0023  es=0023  fs=003b  gs=0000             efl=00000206</p>
<p>    SHLWAPI!PathIsDirectoryA+0x16:</p>
<p>    77ee754e 8945fc          mov     dword ptr [ebp-4],eax ss:0023:0012ff64=fffffffe</p>
<p>    0:000></p>
<p>    eax=00007a43 ebx=7ffde000 ecx=00000001 edx=00422828 esi=0041dc5c edi=7c911970</p>
<p>    eip=77ee7551 esp=0012fd58 ebp=0012ff68 iopl=0         nv up ei pl nz na pe nc</p>
<p>    cs=001b  ss=0023  ds=0023  es=0023  fs=003b  gs=0000             efl=00000206</p>
<p>    SHLWAPI!PathIsDirectoryA+0x19:</p>
<p>    77ee7551 0f8493000000    je      SHLWAPI!PathIsDirectoryA+0xb2 (77ee75ea) [br=0]</p>
<p>    0:000></p>
<p>    eax=00007a43 ebx=7ffde000 ecx=00000001 edx=00422828 esi=0041dc5c edi=7c911970</p>
<p>    eip=77ee7557 esp=0012fd58 ebp=0012ff68 iopl=0         nv up ei pl nz na pe nc</p>
<p>    cs=001b  ss=0023  ds=0023  es=0023  fs=003b  gs=0000             efl=00000206</p>
<p>    SHLWAPI!PathIsDirectoryA+0x1f:</p>
<p>    77ee7557 56              push    esi</p>
<p>    0:000></p>
<p>    eax=00007a43 ebx=7ffde000 ecx=00000001 edx=00422828 esi=0041dc5c edi=7c911970</p>
<p>    eip=77ee7558 esp=0012fd54 ebp=0012ff68 iopl=0         nv up ei pl nz na pe nc</p>
<p>    cs=001b  ss=0023  ds=0023  es=0023  fs=003b  gs=0000             efl=00000206</p>
<p>    SHLWAPI!PathIsDirectoryA+0x20:</p>
<p>    77ee7558 e85cc0fdff      call    SHLWAPI!PathIsUNCServerA (77ec35b9)</p>
<p>    0:000></p>
<p>    eax=00000000 ebx=7ffde000 ecx=00000001 edx=00422828 esi=0041dc5c edi=7c911970</p>
<p>    eip=77ee755d esp=0012fd58 ebp=0012ff68 iopl=0         nv up ei pl zr na pe nc</p>
<p>    cs=001b  ss=0023  ds=0023  es=0023  fs=003b  gs=0000             efl=00000246</p>
<p>    SHLWAPI!PathIsDirectoryA+0x25:</p>
<p>    77ee755d 85c0            test    eax,eax</p>
<p>    0:000></p>
<p>    eax=00000000 ebx=7ffde000 ecx=00000001 edx=00422828 esi=0041dc5c edi=7c911970</p>
<p>    eip=77ee755f esp=0012fd58 ebp=0012ff68 iopl=0         nv up ei pl zr na pe nc</p>
<p>    cs=001b  ss=0023  ds=0023  es=0023  fs=003b  gs=0000             efl=00000246</p>
<p>    SHLWAPI!PathIsDirectoryA+0x27:</p>
<p>    77ee755f 0f8585000000    jne     SHLWAPI!PathIsDirectoryA+0xb2 (77ee75ea) [br=0]</p>
<p>    0:000></p>
<p>    eax=00000000 ebx=7ffde000 ecx=00000001 edx=00422828 esi=0041dc5c edi=7c911970</p>
<p>    eip=77ee7565 esp=0012fd58 ebp=0012ff68 iopl=0         nv up ei pl zr na pe nc</p>
<p>    cs=001b  ss=0023  ds=0023  es=0023  fs=003b  gs=0000             efl=00000246</p>
<p>    SHLWAPI!PathIsDirectoryA+0x2d:</p>
<p>    77ee7565 56              push    esi</p>
<p>    0:000></p>
<p>    eax=00000000 ebx=7ffde000 ecx=00000001 edx=00422828 esi=0041dc5c edi=7c911970</p>
<p>    eip=77ee7566 esp=0012fd54 ebp=0012ff68 iopl=0         nv up ei pl zr na pe nc</p>
<p>    cs=001b  ss=0023  ds=0023  es=0023  fs=003b  gs=0000             efl=00000246</p>
<p>    SHLWAPI!PathIsDirectoryA+0x2e:</p>
<p>    77ee7566 e812feffff      call    SHLWAPI!PathIsUNCServerShareA (77ee737d)</p>
<p>    0:000></p>
<p>    eax=00000000 ebx=7ffde000 ecx=00000001 edx=00422828 esi=0041dc5c edi=7c911970</p>
<p>    eip=77ee756b esp=0012fd58 ebp=0012ff68 iopl=0         nv up ei pl zr na pe nc</p>
<p>    cs=001b  ss=0023  ds=0023  es=0023  fs=003b  gs=0000             efl=00000246</p>
<p>    SHLWAPI!PathIsDirectoryA+0x33:</p>
<p>    77ee756b 85c0            test    eax,eax</p>
<p>    0:000></p>
<p>    eax=00000000 ebx=7ffde000 ecx=00000001 edx=00422828 esi=0041dc5c edi=7c911970</p>
<p>    eip=77ee756d esp=0012fd58 ebp=0012ff68 iopl=0         nv up ei pl zr na pe nc</p>
<p>    cs=001b  ss=0023  ds=0023  es=0023  fs=003b  gs=0000             efl=00000246</p>
<p>    SHLWAPI!PathIsDirectoryA+0x35:</p>
<p>    77ee756d 0f8486000000    je      SHLWAPI!PathIsDirectoryA+0xc1 (77ee75f9) [br=1]</p>
<p>    0:000></p>
<p>    eax=00000000 ebx=7ffde000 ecx=00000001 edx=00422828 esi=0041dc5c edi=7c911970</p>
<p>    eip=77ee75f9 esp=0012fd58 ebp=0012ff68 iopl=0         nv up ei pl zr na pe nc</p>
<p>    cs=001b  ss=0023  ds=0023  es=0023  fs=003b  gs=0000             efl=00000246</p>
<p>    SHLWAPI!PathIsDirectoryA+0xc1:</p>
<p>    77ee75f9 56              push    esi</p>
<p>    0:000></p>
<p>    eax=00000000 ebx=7ffde000 ecx=00000001 edx=00422828 esi=0041dc5c edi=7c911970</p>
<p>    eip=77ee75f9 esp=0012fd58 ebp=0012ff68 iopl=0         nv up ei pl zr na pe nc</p>
<p>    cs=001b  ss=0023  ds=0023  es=0023  fs=003b  gs=0000             efl=00000246</p>
<p>    SHLWAPI!PathIsDirectoryA+0xc1:</p>
<p>    77ee75f9 56              push    esi</p>
<p>    0:000></p>
<p>    eax=00000000 ebx=7ffde000 ecx=00000001 edx=00422828 esi=0041dc5c edi=7c911970</p>
<p>    eip=77ee75fa esp=0012fd54 ebp=0012ff68 iopl=0         nv up ei pl zr na pe nc</p>
<p>    cs=001b  ss=0023  ds=0023  es=0023  fs=003b  gs=0000             efl=00000246</p>
<p>    SHLWAPI!PathIsDirectoryA+0xc2:</p>
<p>    77ee75fa ff15d411ea77    call    dword ptr [SHLWAPI!_imp__GetFileAttributesA (77ea11d4)]</p>
<p>    0:000></p>
<p>    eax=00000011 ebx=7ffde000 ecx=7c91056d edx=00140608 esi=0041dc5c edi=7c911970</p>
<p>    eip=77ee7600 esp=0012fd58 ebp=0012ff68 iopl=0         nv up ei pl zr na pe nc</p>
<p>    cs=001b  ss=0023  ds=0023  es=0023  fs=003b  gs=0000             efl=00000246</p>
<p>    SHLWAPI!PathIsDirectoryA+0xc8:</p>
<p>    77ee7600 83f8ff          cmp     eax,0FFFFFFFFh</p>
<p>    0:000></p>
<p>    eax=00000011 ebx=7ffde000 ecx=7c91056d edx=00140608 esi=0041dc5c edi=7c911970</p>
<p>    eip=77ee7603 esp=0012fd58 ebp=0012ff68 iopl=0         nv up ei pl nz ac pe cy</p>
<p>    cs=001b  ss=0023  ds=0023  es=0023  fs=003b  gs=0000             efl=00000217</p>
<p>    SHLWAPI!PathIsDirectoryA+0xcb:</p>
<p>    77ee7603 74e5            je      SHLWAPI!PathIsDirectoryA+0xb2 (77ee75ea) [br=0]</p>
<p>    0:000></p>
<p>    eax=00000011 ebx=7ffde000 ecx=7c91056d edx=00140608 esi=0041dc5c edi=7c911970</p>
<p>    eip=77ee7605 esp=0012fd58 ebp=0012ff68 iopl=0         nv up ei pl nz ac pe cy</p>
<p>    cs=001b  ss=0023  ds=0023  es=0023  fs=003b  gs=0000             efl=00000217</p>
<p>    SHLWAPI!PathIsDirectoryA+0xcd:</p>
<p>    77ee7605 83e010          and     eax,10h</p>
<p>    0:000></p>
<p>    eax=00000010 ebx=7ffde000 ecx=7c91056d edx=00140608 esi=0041dc5c edi=7c911970</p>
<p>    eip=77ee7608 esp=0012fd58 ebp=0012ff68 iopl=0         nv up ei pl nz na po nc</p>
<p>    cs=001b  ss=0023  ds=0023  es=0023  fs=003b  gs=0000             efl=00000202</p>
<p>    SHLWAPI!PathIsDirectoryA+0xd0:</p>
<p>    77ee7608 ebe2            jmp     SHLWAPI!PathIsDirectoryA+0xb4 (77ee75ec)</p>
<p>    0:000></p>
<p>    eax=00000010 ebx=7ffde000 ecx=7c91056d edx=00140608 esi=0041dc5c edi=7c911970</p>
<p>    eip=77ee75ec esp=0012fd58 ebp=0012ff68 iopl=0         nv up ei pl nz na po nc</p>
<p>    cs=001b  ss=0023  ds=0023  es=0023  fs=003b  gs=0000             efl=00000202</p>
<p>    SHLWAPI!PathIsDirectoryA+0xb4:</p>
<p>    77ee75ec 8b4dfc          mov     ecx,dword ptr [ebp-4] ss:0023:0012ff64=00007a43</p>
<p>    0:000></p>
<p>    eax=00000010 ebx=7ffde000 ecx=00007a43 edx=00140608 esi=0041dc5c edi=7c911970</p>
<p>    eip=77ee75ef esp=0012fd58 ebp=0012ff68 iopl=0         nv up ei pl nz na po nc</p>
<p>    cs=001b  ss=0023  ds=0023  es=0023  fs=003b  gs=0000             efl=00000202</p>
<p>    SHLWAPI!PathIsDirectoryA+0xb7:</p>
<p>    77ee75ef 5e              pop     esi</p>
<p>    0:000></p>
<p>    eax=00000010 ebx=7ffde000 ecx=00007a43 edx=00140608 esi=0006f4cc edi=7c911970</p>
<p>    eip=77ee75f0 esp=0012fd5c ebp=0012ff68 iopl=0         nv up ei pl nz na po nc</p>
<p>    cs=001b  ss=0023  ds=0023  es=0023  fs=003b  gs=0000             efl=00000202</p>
<p>    SHLWAPI!PathIsDirectoryA+0xb8:</p>
<p>    77ee75f0 e82bcafbff      call    SHLWAPI!__security_check_cookie (77ea4020)</p>
<p>    0:000></p>
<p>    eax=00000010 ebx=7ffde000 ecx=00007a43 edx=00140608 esi=0006f4cc edi=7c911970</p>
<p>    eip=77ee75f5 esp=0012fd5c ebp=0012ff68 iopl=0         nv up ei pl zr na pe nc</p>
<p>    cs=001b  ss=0023  ds=0023  es=0023  fs=003b  gs=0000             efl=00000246</p>
<p>    SHLWAPI!PathIsDirectoryA+0xbd:</p>
<p>    77ee75f5 c9              leave</p>
<p>    0:000></p>
<p>    eax=00000010 ebx=7ffde000 ecx=00007a43 edx=00140608 esi=0006f4cc edi=7c911970</p>
<p>    eip=77ee75f6 esp=0012ff6c ebp=0012ff78 iopl=0         nv up ei pl zr na pe nc</p>
<p>    cs=001b  ss=0023  ds=0023  es=0023  fs=003b  gs=0000             efl=00000246</p>
<p>    SHLWAPI!PathIsDirectoryA+0xbe:</p>
<p>    77ee75f6 c20400          ret     4</p>
<p>    0:000></p>
<p>    eax=00000010 ebx=7ffde000 ecx=00007a43 edx=00140608 esi=0006f4cc edi=7c911970</p>
<p>    eip=0040101f esp=0012ff74 ebp=0012ff78 iopl=0         nv up ei pl zr na pe nc</p>
<p>    cs=001b  ss=0023  ds=0023  es=0023  fs=003b  gs=0000             efl=00000246</p>
<p>    IsPathDir!main+0xf:</p>
<p>    0040101f 8945fc          mov     dword ptr [ebp-4],eax ss:0023:0012ff74=00000001</p>
<p>    0:000></p>
<p>    eax=00000010 ebx=7ffde000 ecx=00007a43 edx=00140608 esi=0006f4cc edi=7c911970</p>
<p>    eip=00401022 esp=0012ff74 ebp=0012ff78 iopl=0         nv up ei pl zr na pe nc</p>
<p>    cs=001b  ss=0023  ds=0023  es=0023  fs=003b  gs=0000             efl=00000246</p>
<p>    IsPathDir!main+0x12:</p>
<p>    00401022 8b45fc          mov     eax,dword ptr [ebp-4] ss:0023:0012ff74=00000010</p>
<p>    0:000></p>
<p>    eax=00000010 ebx=7ffde000 ecx=00007a43 edx=00140608 esi=0006f4cc edi=7c911970</p>
<p>    eip=00401025 esp=0012ff74 ebp=0012ff78 iopl=0         nv up ei pl zr na pe nc</p>
<p>    cs=001b  ss=0023  ds=0023  es=0023  fs=003b  gs=0000             efl=00000246</p>
<p>    IsPathDir!main+0x15:</p>
<p>    00401025 50              push    eax</p>
<p>    0:000></p>
<p>    eax=00000010 ebx=7ffde000 ecx=00007a43 edx=00140608 esi=0006f4cc edi=7c911970</p>
<p>    eip=00401026 esp=0012ff70 ebp=0012ff78 iopl=0         nv up ei pl zr na pe nc</p>
<p>    cs=001b  ss=0023  ds=0023  es=0023  fs=003b  gs=0000             efl=00000246</p>
<p>    IsPathDir!main+0x16:</p>
<p>    00401026 6868dc4100      push    offset IsPathDir!__xt_z+0x12c (0041dc68)</p>
<p>    0:000></p>
<p>    eax=00000010 ebx=7ffde000 ecx=00007a43 edx=00140608 esi=0006f4cc edi=7c911970</p>
<p>    eip=0040102b esp=0012ff6c ebp=0012ff78 iopl=0         nv up ei pl zr na pe nc</p>
<p>    cs=001b  ss=0023  ds=0023  es=0023  fs=003b  gs=0000             efl=00000246</p>
<p>    IsPathDir!main+0x1b:</p>
<p>    0040102b e81a000000      call    IsPathDir!printf (0040104a)</p>
<p>    0:000></p>
<p>    Resultado: 16.</p>
<p>    eax=0000000f ebx=7ffde000 ecx=004010e5 edx=004228b8 esi=0006f4cc edi=7c911970</p>
<p>    eip=00401030 esp=0012ff6c ebp=0012ff78 iopl=0         nv up ei ng nz ac pe nc</p>
<p>    cs=001b  ss=0023  ds=0023  es=0023  fs=003b  gs=0000             efl=00000296</p>
<p>    IsPathDir!main+0x20:</p>
<p>    00401030 83c408          add     esp,8</p>
<p>    0:000></p>
<p>Ou seja, para pastas locais a fun√ß√£o simplesmente usa a conhecid√≠ssima GetFileAttributes, que retorna o flag 0x10 setado caso se trate de uma pasta, de acordo com a documenta√ß√£o: "The attributes can be one or more of the following values:"</p>
<p>    Return code/value ¬†¬†¬†          Description</p>
<p>    FILE_ATTRIBUTE_ARCHIVE¬†¬†¬†¬†¬†¬†¬†¬† A file or directory that is an archive file or directory.</p>
<p>    32</p>
<p>    0x20</p>
<p>    FILE_ATTRIBUTE_COMPRESSED¬†¬†¬†¬†¬† A file or directory that is compressed.</p>
<p>    2048</p>
<p>    0x800</p>
<p>    ...</p>
<p>    </p>
<p>    FILE_ATTRIBUTE_DIRECTORY¬†      The handle that identifies a directory.</p>
<p>    16</p>
<p>    0x10</p>
<p>Aqui termina nossa d√∫vida sobre o pequenino bug na documenta√ß√£o. E isso nos lembra tamb√©m que √© sempre bom comparar as coisas da melhor maneira poss√≠vel. E essa melhor maneira em se tratando de ifs √© supor apenas dois valores bin√°rio: ou √© zero ou √© n√£o-zero.</p>

</div>
  <div class="taglist">
  <p class="author">Wanderley Caloni,
     <a href="https://github.com/Caloni/blog/blob/master/content/posts/todo-dunno-original-post-source">
     2012-02-15 00:00:00 &#43;0000
     </a>
  </p>
  <a href="/categories/writting">writting</a> 
  <a href="/tags/movies">movies</a> 
  <a class="externalgray" href="https://t.me/paneloni">discuss</a>
  <script type="text/javascript" src="//cdn.livetrafficfeed.com/static/hitcounterjs/live.js?sty=49&min=1&sta=0&uni=1&tz=America%2FSao_Paulo&ro=0"></script><noscript id="LTF_hitcounter"><a href="https://livetrafficfeed.com/hit-counter">Hit Counter</a></noscript>
  </div>
  </div>
  </body>
  </html>
