<!DOCTYPE html>
<html lang="en-us" dir="ltr" itemscope itemtype="http://schema.org/Article">
  <head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Blogue do Caloni - 2 Coelhos</title>
  <meta name="author" content="" />
  <meta name="generator" content="Hugo 0.110.0">
  <meta property="og:title" content="2 Coelhos"/>
  <meta property="og:type"
        content="article"/>
  <meta property="og:url" content="http://www.caloni.com.br/todo-put-original-title-slug/"/>
  <meta property="og:image"
        content="/img/author.jpg"/>
  <meta property="og:description"
        content="Uma montagem impec·vel consegue dar o tom da narrativa do complexo 2 Coelhos. AlÈm de complexo, existem pequenos detalhes da trama que forÁam um pouco a realidade (como a uni„o entre o protagonista e..."/>
  <link href="" rel="feed" type="application/rss+xml"
        title="Blogue do Caloni"/>
  <link rel="stylesheet" type="text/css" href="/css/custom.css"/>
  <link rel="stylesheet" type="text/css" href="/css/jquery-ui.css"/>
  <link rel="stylesheet" type="text/css" href="/css/board-min.css"/>
  <script src="/js/jquery-1.10.2.js"></script>
  <script src="/js/jquery-ui.js"></script>
  <script src="/js/pgnyui.js"></script>
  <script src="/js/pgnviewer.js"></script>
  <script src="/js/list.js"></script>
  <link rel="icon" href="/img/favicon.ico"/>
</head>
<body style="min-height:100vh;display:flex;flex-direction:column">
  <nav class="navbar has-shadow is-white"
        role="navigation" aria-label="main navigation">
  <div class="container">
  <div class="navbar-brand">
  <pre><span style="font-size: 3px; margin: 0; display: block;">
&amp;*/. .*%@@@@@@@@@@@@&amp;/    , &amp;@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@#,*@@@@%,*&amp;@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@./@.(@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@@@@**#./((,*, *./((*,#,&amp;@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@@@@@.#@@%&amp;@@* (@@%&amp;@@/#@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@@@@@,#@@&amp;&amp;@@, (@@&amp;&amp;@@*#@@@@@@@@@@@@@#/,,.         ..,/#&amp;@@@@@@@@@@@@@@@@@@@@@@@
@@@@@&amp;, .//      .//  .%@@@@@@&amp;#.  .,****.,*************,.  .(&amp;@@@@@@@@@@@@@@@@@
@@@*                     ,@/  .**,,,*********,   ,***,   ****    *@@@@@@@@@@@@@@
@#                         ,***      .******       ,***,*****,      *&amp;@@@@@@@@@@
&amp;                           ,**      .******.     .******************  (@@@@@@@@
                             ****..,*************************,    ,***   (@@@@@@
@@@@#,,,,,,,,,,,,,,,,,,,,*********,   ,**************,  .***,      .**. .  %@@@@
@@@@%                   .***,.,****,.,***,     ,****      ***.     ,******, /@@@
@@@@@&amp;.                ,**       *******,       *****,  .******************, *@@
@@@@@@@&amp;,            ,****      .********,.   .*************,  ,*****,    ,** /@
@@@@@@@@@@@@&amp;/ .****,    ************.   ****************************      **. #
@@@@@@@@@@@@@, *****,    ,***********    .******,   ,****.   .*****,***,,***** ,
@@@@@@@@@@@@&amp;..**************,  ,***********************       ,*,    ********..
@@@@@@@@@@@@&amp; ,**.    ,******.  .*******.    .**********,     .**********. .**, 
@@@@@@@@@@@@% ,*       ,***************.      .*****************************,   
@@@@@@@@@@@@@&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;@,(&amp;&amp;&amp;&amp;@,(&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;#*@&amp;&amp;&amp;@*#&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;
@@@@@@@@@@@@@@@@@@@@@@@@@@@@(.#@@@@(.#@@@@@@@@@@@@@@@@@@@@@#**@@@@(.#@@@@@@@@@@@
  </span></pre>
  &nbsp;
  <a class="navbar-item" title="Go to Home" href="/">
    <div class="is-6">Blogue do Caloni</div>
  </a>
  </div>
  </div>
  </nav>
  <div class="container">
  <p class="title">
  <a class="external" href="https://www.caloni.com.br/todo-put-external-link-here">
  Todo Put Post Title Here
  </a>
  </p>
  <div class="content">
<p>Como alguns devem saber, e outros n√£o (ou n√£o deveriam), existe uma competi√ß√£o internacional para escolher quem escreve o c√≥digo em C mais ofuscado. Isso mesmo. O evento se chama [The International Obfuscated C Code Contest] (IOCCC resumidamente) e costuma premiar anualmente os melhores "do ramo" com a chamada "men√ß√£o desonrosa".</p>
<p>Acredito que a real valia de um campeonato desse porte √© fazer as pessoas pensarem mais a fundo sobre as regras da linguagem. Isso faz com que erros mais obscuros que encontramos no dia-a-dia se tornem mais f√°ceis. Claro que ningu√©m deveria programar como os caras desse torneio, mas a t√≠tulo de aprendizagem, √© uma grande aula sobre C.</p>
<p>Publico aqui a interpreta√ß√£o do primeiro programa a ganhar a tal [men√ß√£o desonrosa], em 1984. Se trata do batid√≠ssimo "Hello World", s√≥ que um pouco compactado e confuso. Vejamos o fonte original:</p>
<p>Aparentemente o fonte √© bem confuso, apesar de podermos j√° ver a famosa string escondida no meio do c√≥digo. Depois de aplicar uma formata√ß√£o mais adequada para nossa tarefa de desfazer o feito, o resultado √© bem mais leg√≠vel:</p>
<p>Algumas constru√ß√µes s√£o √≥bvias. Vamos ent√£o partir para as n√£o-t√£o-√≥bvias.</p>
<p>Como toda vari√°vel global inteira, √© inicializada com zero. Logo, a linha acima √© equivalente a "int i =0".</p>
<p>Aos programadores C++ desavisados de plant√£o, em C o valor de retorno padr√£o √© int, e, caso n√£o seja retornado nada, isso n√£o constitui um erro, por√©m o comportamento √© n√£o-definido. Nada de mal, por√©m, pode ocorrer, a n√£o ser o retorno de lixo da pilha.</p>
<p>Outra coisa √≥bvia, mas n√£o tanto, √© um la√ßo for sem corpo. Ele possui apenas um ponto-e-v√≠rgula, que identifica uma instru√ß√£o nula. N√£o faz nada no corpo, mas pode fazer coisas interessantes no cabe√ßalho, ou seja, na inicializa√ß√£o, no teste e no incremento. Como podemos ver, a inicializa√ß√£o tamb√©m est√° vazia, contendo esse la√ßo apenas o teste e o incremento. No teste temos a seguinte compara√ß√£o:</p>
<p>Ora, sabendo que a vari√°vel "i" inicialmente tem o valor zero, o que estamos vendo aqui √© a mesma coisa que</p>
<p>Agora ficou mais f√°cil de entender. Se trocarmos a nossa string literal por uma vari√°vel (forma mais usual), temos um acesso t√≠pico a um dos caracteres de uma string:</p>
<p>S√≥ precisamos lembrar que a vari√°vel i √© que define a posi√ß√£o, e por ser uma vari√°vel, pode mudar durante a execu√ß√£o:</p>
<p>Pois bem. Agora sabemos que o la√ßo ir√° ser testado pelo menos uma vez, o que quer dizer que a parte do incremento vai executar pelo menos uma vez. E essa parte √© a seguinte:</p>
<p>Uma chamada de fun√ß√£o. Nada mais simples. Podemos anular algumas coisas por aqui. Por exemplo, se subtra√≠mos um n√∫mero dele mesmo encontramos zero, e se dividirmos um n√∫mero por ele mesmo o resultado √© um:</p>
<p>Lembre-se de que um caractere em C √© um tipo inteiro, e portanto, pode fazer parte de c√°lculos matem√°ticos. Depois dessa simplifica√ß√£o, temos</p>
<p>Agora voc√™ deveria estar se perguntando (se ainda n√£o encontrou a resposta) do porqu√™ de eu ter dividido os tr√™s sinais de + dessa forma. Existem duas op√ß√µes para a divis√£o:</p>
<p>Voltando √† express√£o, imagino que a essa altura voc√™ j√° deva ter decifrado que i++ + "hello, world!\n" √© o mesmo que:</p>
<p>Ou seja, obtemos o endere√ßo do primeiro caractere da string e incrementamos nossa vari√°vel "i" que, como sabemos, √© usada no teste do la√ßo for. Na primeira vez, testamos se o primeiro caractere de "] < i; ++i ){--i;}" √© diferente de zero. Na segunda itera√ß√£o, portanto, iremos testar se o segundo caractere ser√° zero. Sabendo disso, podemos deduzir que o la√ßo ir√° correr por todos os caracteres da string de teste, at√© encontrar o zero finalizador de string. Ao mesmo tempo, iremos enviar para a fun√ß√£o read sempre o endere√ßo do i'√©simo caractere da string "hello, world!\n", pois essa string tamb√©m √© indexada pela vari√°vel "i".</p>
<p>Isso quer dizer que nosso la√ßo ir√° terminar exatamente no final de ambas as strings! (Note, que para comparar as strings, usamos as strings originais do programa, sem melhorar a formata√ß√£o).</p>
<p>Tamb√©m devemos lembrar que o caractere de controle '\n' √© representado apenas por um byte, apesar de no fonte parecer dois.</p>
<p>Em um passado bem long√≠nquo, o padr√£o ANSI C n√£o existia, e outras fun√ß√µes dominavam o ambiente UNIX. Muitas dessas fun√ß√µes foram adaptadas, e outras completamente copiadas para a forma√ß√£o do padr√£o. No entanto, ainda que o padr√£o n√£o tenha colocado algumas fun√ß√µes cl√°ssicas, elas continuaram sendo usadas e suportadas. Um bom exemplo disso s√£o as fun√ß√µes read e write, que, apesar de n√£o estarem no padr√£o, est√£o no [livro de K&R], no cap√≠tulo sobre fluxos (streams) em UNIX, provando que s√£o bem populares.</p>
<p>Dentro desse mundo paralelo, existem identificadores de fluxos padr√µes para a entrada e a sa√≠da padr√£o. Melhor ainda, esses identificadores s√£o inteiros que est√£o especificados da seguinte maneira (tirado da [refer√™ncia GNU] da linguagem C, meu grifo):</p>
<p>Agora podemos voltar ao fonte. Vejamos como √© implementada a fun√ß√£o read, chamada dentro do la√ßo for. Como todos sabem, se uma fun√ß√£o j√° √© definida em sua pr√≥pria unidade, n√£o haver√° uma busca por refer√™ncias externas, o que quer dizer que a implementa√ß√£o padr√£o de read n√£o atrapalha a implementa√ß√£o local.</p>
<p>√ìtimo. A fun√ß√£o read chama a fun√ß√£o (essa sim, padr√£o) write. Sabemos que tanto o primeiro quanto o √∫ltimo par√¢metro da fun√ß√£o ser√° sempre constante no la√ßo for:</p>
<p>Al√©m da constante √≥bvia passada no √∫ltimo argumento:</p>
<p>Isso quer dizer que a chamada para write pode ser resumida para:</p>
<p>Pronto, j√° temos condi√ß√µes de interpretar o significado dessa chamada √† write. Como j√° vimos, o n√∫mero 1 identifica a sa√≠da padr√£o, o que quer dizer que estamos escrevendo algo na sa√≠da padr√£o. Esse algo √© o par√¢metro "i" que, como vimos, √© o endere√ßo do i'√©simo caractere da string "hello, word!\n". O √∫ltimo argumento √© o n√∫mero de bytes a serem escritos, que ser√° sempre um. O que quer dizer que o la√ßo em for chamada a fun√ß√£o read strlen("hello, world!\n") vezes passando o endere√ßo do pr√≥ximo caractere de cada vez. A fun√ß√£o read, por sua vez, escreve este caractere na sa√≠da padr√£o. O resultado, como todos que compilarem o fonte e rodarem poder√£o comprovar, √© a impress√£o da mensagem mais famosa do mundo da computa√ß√£o:</p>
<p>Abaixo um c√≥digo-fonte equivalente, devidamente desencriptado:</p>
<p>[The International Obfuscated C Code Contest]: http://www.ioccc.org</p>
<p>[men√ß√£o desonrosa]: http://www.ioccc.org/1984/anonymous/anonymous.c</p>
<p>[peculiaridades sobre o operador de subscrito]: {{< relref "curiosidades-inuteis-o-operador-de-subscrito-em-c" >}}</p>
<p>[livro de K&R]: {{< relref "the-c-programming-language" >}}</p>
<p>[refer√™ncia GNU]: http://www.gnu.org/software/libc/manual/html_node/Descriptors-and-Streams.html#index-STDIN_005fFILENO-1235</p>
</div>
  <div class="taglist">
  <p class="author">Wanderley Caloni,
     <a href="https://github.com/Caloni/blog/blob/master/content/posts/todo-dunno-original-post-source">
     2012-02-15 00:00:00 &#43;0000
     </a>
  </p>
  <a href="/categories/writting">writting</a> 
  <a href="/tags/movies">movies</a> 
  <a class="externalgray" href="https://t.me/paneloni">discuss</a>
  <script type="text/javascript" src="//cdn.livetrafficfeed.com/static/hitcounterjs/live.js?sty=49&min=1&sta=0&uni=1&tz=America%2FSao_Paulo&ro=0"></script><noscript id="LTF_hitcounter"><a href="https://livetrafficfeed.com/hit-counter">Hit Counter</a></noscript>
  </div>
  </div>
  </body>
  </html>
