<!DOCTYPE html>
<html lang="en-us" dir="ltr" itemscope itemtype="http://schema.org/Article">
  <head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Blogue do Caloni - 2 Coelhos</title>
  <meta name="author" content="" />
  <meta name="generator" content="Hugo 0.110.0">
  <meta property="og:title" content="2 Coelhos"/>
  <meta property="og:type"
        content="article"/>
  <meta property="og:url" content="http://www.caloni.com.br/todo-put-original-title-slug/"/>
  <meta property="og:image"
        content="/img/author.jpg"/>
  <meta property="og:description"
        content="Uma montagem impec·vel consegue dar o tom da narrativa do complexo 2 Coelhos. AlÈm de complexo, existem pequenos detalhes da trama que forÁam um pouco a realidade (como a uni„o entre o protagonista e..."/>
  <link href="" rel="feed" type="application/rss+xml"
        title="Blogue do Caloni"/>
  <link rel="stylesheet" type="text/css" href="/css/custom.css"/>
  <link rel="stylesheet" type="text/css" href="/css/jquery-ui.css"/>
  <link rel="stylesheet" type="text/css" href="/css/board-min.css"/>
  <script src="/js/jquery-1.10.2.js"></script>
  <script src="/js/jquery-ui.js"></script>
  <script src="/js/pgnyui.js"></script>
  <script src="/js/pgnviewer.js"></script>
  <script src="/js/list.js"></script>
  <link rel="icon" href="/img/favicon.ico"/>
</head>
<body style="min-height:100vh;display:flex;flex-direction:column">
  <nav class="navbar has-shadow is-white"
        role="navigation" aria-label="main navigation">
  <div class="container">
  <div class="navbar-brand">
  <pre><span style="font-size: 3px; margin: 0; display: block;">
&amp;*/. .*%@@@@@@@@@@@@&amp;/    , &amp;@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@#,*@@@@%,*&amp;@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@./@.(@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@@@@**#./((,*, *./((*,#,&amp;@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@@@@@.#@@%&amp;@@* (@@%&amp;@@/#@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@@@@@,#@@&amp;&amp;@@, (@@&amp;&amp;@@*#@@@@@@@@@@@@@#/,,.         ..,/#&amp;@@@@@@@@@@@@@@@@@@@@@@@
@@@@@&amp;, .//      .//  .%@@@@@@&amp;#.  .,****.,*************,.  .(&amp;@@@@@@@@@@@@@@@@@
@@@*                     ,@/  .**,,,*********,   ,***,   ****    *@@@@@@@@@@@@@@
@#                         ,***      .******       ,***,*****,      *&amp;@@@@@@@@@@
&amp;                           ,**      .******.     .******************  (@@@@@@@@
                             ****..,*************************,    ,***   (@@@@@@
@@@@#,,,,,,,,,,,,,,,,,,,,*********,   ,**************,  .***,      .**. .  %@@@@
@@@@%                   .***,.,****,.,***,     ,****      ***.     ,******, /@@@
@@@@@&amp;.                ,**       *******,       *****,  .******************, *@@
@@@@@@@&amp;,            ,****      .********,.   .*************,  ,*****,    ,** /@
@@@@@@@@@@@@&amp;/ .****,    ************.   ****************************      **. #
@@@@@@@@@@@@@, *****,    ,***********    .******,   ,****.   .*****,***,,***** ,
@@@@@@@@@@@@&amp;..**************,  ,***********************       ,*,    ********..
@@@@@@@@@@@@&amp; ,**.    ,******.  .*******.    .**********,     .**********. .**, 
@@@@@@@@@@@@% ,*       ,***************.      .*****************************,   
@@@@@@@@@@@@@&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;@,(&amp;&amp;&amp;&amp;@,(&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;#*@&amp;&amp;&amp;@*#&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;
@@@@@@@@@@@@@@@@@@@@@@@@@@@@(.#@@@@(.#@@@@@@@@@@@@@@@@@@@@@#**@@@@(.#@@@@@@@@@@@
  </span></pre>
  &nbsp;
  <a class="navbar-item" title="Go to Home" href="/">
    <div class="is-6">Blogue do Caloni</div>
  </a>
  </div>
  </div>
  </nav>
  <div class="container">
  <p class="title">
  <a class="external" href="https://www.caloni.com.br/todo-put-external-link-here">
  Todo Put Post Title Here
  </a>
  </p>
  <div class="content">
<p>Quase todos os problemas do Universo s√£o resolvidos depois de um belo dia de depura√ß√£o, c√≥digo comentado, descomentado, recomentado e umas muitas e boas doses de caf√©. Alguns outros problemas mais cabeludos precisam de uma boa noitada na frente do computador, e mais caf√©. E, finalmente, existem aqueles que nem tomando o estoque inteiro de caf√© a coisa anda.</p>
<p>Um exemplo: um hook global do Windows que quando ativado em determinados eventos envia mensagens para uma √∫nica janela que cataloga informa√ß√µes sobre diversas janelas e processos no sistema. Esse procedimento √© uma subfun√ß√£o do programa principal, que j√° possui seus pr√≥prios problemas e idiossincrasias. Em momentos aparentemente aleat√≥rios algumas funcionalidades n√£o parecem estar de acordo com o que se espera.</p>
<p>Para esse tipo de situa√ß√£o que envolve 1. o sistema como um todo, 2. processos de terceiros e 3. comportamento obscuro por parte do resto do c√≥digo, vale a pena seguir um checklist mais rigoroso, colocar seu bonezinho de CSI e partir para desmembrar o funcionamento do c√≥digo problem√°tico:</p>
<p>  1. Como o programa deveria funcionar?</p>
<p>  2. O que exatamente n√£o funciona?</p>
<p>  3. O que pode ser? O que N√ÉO pode ser?</p>
<p>  4. Existe uma maneira de provar?</p>
<p>Cada uma dessas perguntas deve ser respondida com a maior sinceridade e disciplina, custe o que custar.</p>
<p>Esse deve ser o primeiro e mais importante ind√≠cio do que pode estar acontecendo. Sem entender o funcionamento do programa, dificilmente conseguiremos passar para os passos seguintes. Na maioria das vezes, sem saber onde a coisa come√ßa e termina, o problema vai ficar rindo da nossa cara at√© entendermos de fato que aquele if n√£o merece estar naquela linha.</p>
<p>Para facilitar esse entendimento, nada como elaborar uma pequena explica√ß√£o para si mesmo no estilo How Stuff Works. N√£o precisa exagerar e fazer uma tese a respeito e criar v√≠deos explicativos. S√≥ precisa descrever o fluxo com os detalhes aparentemente importantes para a resolu√ß√£o do problema.</p>
<p>Continuando nosso exemplo:</p>
<p>  1. O programa inicia e cria uma _thread _espec√≠fica.</p>
<p>  2. Essa _thread _espec√≠fica cria uma janela que monitora e carrega uma DLL.</p>
<p>  3. Essa DLL √© chamada pela _thread _e instala um _hook _global no sistema.</p>
<p>  4. O _hook _recebe eventos de todos os processos que possuem janelas.</p>
<p>  5. Quando eventos espec√≠ficos s√£o disparados, o processo atual envia uma mensagem para a janela que monitora.</p>
<p>  6. A janela que monitora monta uma tabela estat√≠stica dos eventos.</p>
<p>  7. De tempos em tempos, essa tabela √© escrita em disco em um arquivo encriptado.</p>
<p>A lista acima √© longa o suficiente para podermos elaborar perguntas interessantes e pequena o suficiente para podermos ter em mente o seu funcionamento como um todo, o que √© vital para o sucesso das observa√ß√µes durante a depura√ß√£o.</p>
<p>Note que a pergunta nos direciona para o sintoma do problema, n√£o o problema em si, que provavelmente ainda n√£o √© conhecido. E nunca √© demais lembrar que podemos estar lidando com uma s√©rie de problemas trabalhando em conjunto para nos deixar acordados por dias a fio.</p>
<p>Exemplos de respostas poss√≠veis: a tabela estat√≠stica perde a l√≥gica em determinado momento, o hook algumas vezes n√£o funciona, aleatoriamente um dos processos "hookados" capota.</p>
<p>Essa pergunta deve ser respondida com uma an√°lise das respostas das duas primeiras perguntas. Batendo os sintomas do problema com o seu funcionamento macro, uma ou mais cabe√ßas aos poucos ir√£o elaborando teorias a respeito de onde pode estar falhando.</p>
<p>Ex: talvez por algum motivo a DLL esteja sendo descarregada (que lugares podem ser estes?), algu√©m est√° desinstalando o hook (quais as partes do c√≥digo que fazem isso?), alguma ferramenta de an√°lise est√° atrapalhando nossos resultados (o que acontece se rodarmos sem o DebugView?).</p>
<p>Ao mesmo tempo que os sintomas do problema acusam que algo est√° errado, existem os sintomas de que alguma coisa, afinal de contas, est√° funcionando nessa porcaria de c√≥digo. Atrav√©s dos sintomas positivos √© poss√≠vel chegar a algumas conclus√µes sobre o que est√° funcionando bem.</p>
<p>Ex: o arquivo de log est√° sendo atualizado, a thread da janela que monitora recebe mensagens continuamente, algumas informa√ß√µes da tabela n√£o est√£o corrompidas.</p>
<p>Esse √© o pulo do gato, a parte que diferencia meninos e meninas de homens e mulheres. Se conseguirmos, atrav√©s de c√≥digo de teste e/ou observa√ß√£o, aos poucos provar nossas conclus√µes a respeito do problema e conseguir elaborar, passo a passo, uma "maquete mental" de todo o c√≥digo funcional, ser√° poss√≠vel aos poucos ir descartando teorias e refor√ßando nossa confian√ßa sobre o caminho que estamos trilhando.</p>
<p>√Äs vezes uma pequena mudan√ßa no c√≥digo pode provar in√∫meras coisas, como inocentar algumas partes e proteger-se de acusa√ß√µes infundadas feitas anteriormente. √â uma briga contra o pr√≥prio ego, especialmente se o c√≥digo foi feito por voc√™ mesmo.</p>
<p>Ex: Desabilitei o tratamento dos eventos e o hook continua funcionando.</p>
<p>O importante √© nunca parar de pensar sobre o problema, evitando ao m√°ximo agir mecanicamente e por impulso, a n√£o ser que exista um bom motivo para isso. √Äs vezes apenas pensando de novo sobre o mesmo assunto comprova-se algo. √â uma fase muito rica e pr√≥spera na resolu√ß√£o de problemas e deve ser aproveitada.</p>
<p>Ex: Quando estava habilitado o tratamento de eventos, o hook parava de funcionar em menos de cinco minutos. Agora, rodando os testes por tr√™s horas, o hook continua ativo.</p>
<p>Ex: Desabilitei um dos eventos que possui comunica√ß√£o remota com o servidor. O hook continuou funcionando, apesar do resto dos eventos.</p>
<p>Por fim, com uma pequena dose de sorte e muitas doses de for√ßa de vontade (e caf√©), o problema cansa de se esconder e mostra a cara.</p>
<p>Ex: Quando h√° falha na comunica√ß√£o com o servidor com o erro 666 uma exce√ß√£o √© lan√ßada, e quando capturada tenta gerar um logue, s√≥ que esse logue est√° mal formatado e causa com que a thread inteira v√° para o espa√ßo.</p>
<p>Essa √© a hora em que todos se esquecem do esfor√ßo que custou chegar at√© ali e n√£o documentam nada do que foi feito. Desse jeito perde-se todo esse tempo n√£o apenas uma vez, mas todas as vezes que algu√©m diferente do time mexer com a mesma situa√ß√£o. Por isso deve-se, com a cuca fresca, escrever algumas dicas de como reproduzir o problema e elaborar um pequeno relat√≥rio ou algo que o valha¬†do que foi feito, como foi feito e por que funcionou. Mais uma vez, n√£o exagere. Deixe as apresenta√ß√µes sofisticadas de PowerPoint para os outros departamentos da empresa.</p>
<p>Como deve ter parecido, esse tipo de abordagem leva tempo e n√£o √© f√°cil de ser levado adiante sem disciplina e muita persist√™ncia. Por esse motivo √© que s√≥ deve ser usado naqueles problemas em que j√° se perdeu uma imensidade de tempo e esperan√ßa, uma situa√ß√£o irremedi√°vel e que ainda n√£o conseguiu vislumbrar o dia em que finalmente poderemos dedicar nossas vidas profissionais para uma outra tarefa mais interessante.</p>

</div>
  <div class="taglist">
  <p class="author">Wanderley Caloni,
     <a href="https://github.com/Caloni/blog/blob/master/content/posts/todo-dunno-original-post-source">
     2012-02-15 00:00:00 &#43;0000
     </a>
  </p>
  <a href="/categories/writting">writting</a> 
  <a href="/tags/movies">movies</a> 
  <a class="externalgray" href="https://t.me/paneloni">discuss</a>
  <script type="text/javascript" src="//cdn.livetrafficfeed.com/static/hitcounterjs/live.js?sty=49&min=1&sta=0&uni=1&tz=America%2FSao_Paulo&ro=0"></script><noscript id="LTF_hitcounter"><a href="https://livetrafficfeed.com/hit-counter">Hit Counter</a></noscript>
  </div>
  </div>
  </body>
  </html>
