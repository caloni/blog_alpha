<!DOCTYPE html>
<html lang="en-us" dir="ltr" itemscope itemtype="http://schema.org/Article">
  <head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Blogue do Caloni - 2 Coelhos</title>
  <meta name="author" content="" />
  <meta name="generator" content="Hugo 0.110.0">
  <meta property="og:title" content="2 Coelhos"/>
  <meta property="og:type"
        content="article"/>
  <meta property="og:url" content="http://www.caloni.com.br/todo-put-original-title-slug/"/>
  <meta property="og:image"
        content="/img/author.jpg"/>
  <meta property="og:description"
        content="Uma montagem impec·vel consegue dar o tom da narrativa do complexo 2 Coelhos. AlÈm de complexo, existem pequenos detalhes da trama que forÁam um pouco a realidade (como a uni„o entre o protagonista e..."/>
  <link href="" rel="feed" type="application/rss+xml"
        title="Blogue do Caloni"/>
  <link rel="stylesheet" type="text/css" href="/css/custom.css"/>
  <link rel="stylesheet" type="text/css" href="/css/jquery-ui.css"/>
  <link rel="stylesheet" type="text/css" href="/css/board-min.css"/>
  <script src="/js/jquery-1.10.2.js"></script>
  <script src="/js/jquery-ui.js"></script>
  <script src="/js/pgnyui.js"></script>
  <script src="/js/pgnviewer.js"></script>
  <script src="/js/list.js"></script>
  <link rel="icon" href="/img/favicon.ico"/>
</head>
<body style="min-height:100vh;display:flex;flex-direction:column">
  <nav class="navbar has-shadow is-white"
        role="navigation" aria-label="main navigation">
  <div class="container">
  <div class="navbar-brand">
  <pre><span style="font-size: 3px; margin: 0; display: block;">
&amp;*/. .*%@@@@@@@@@@@@&amp;/    , &amp;@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@#,*@@@@%,*&amp;@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@./@.(@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@@@@**#./((,*, *./((*,#,&amp;@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@@@@@.#@@%&amp;@@* (@@%&amp;@@/#@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@@@@@,#@@&amp;&amp;@@, (@@&amp;&amp;@@*#@@@@@@@@@@@@@#/,,.         ..,/#&amp;@@@@@@@@@@@@@@@@@@@@@@@
@@@@@&amp;, .//      .//  .%@@@@@@&amp;#.  .,****.,*************,.  .(&amp;@@@@@@@@@@@@@@@@@
@@@*                     ,@/  .**,,,*********,   ,***,   ****    *@@@@@@@@@@@@@@
@#                         ,***      .******       ,***,*****,      *&amp;@@@@@@@@@@
&amp;                           ,**      .******.     .******************  (@@@@@@@@
                             ****..,*************************,    ,***   (@@@@@@
@@@@#,,,,,,,,,,,,,,,,,,,,*********,   ,**************,  .***,      .**. .  %@@@@
@@@@%                   .***,.,****,.,***,     ,****      ***.     ,******, /@@@
@@@@@&amp;.                ,**       *******,       *****,  .******************, *@@
@@@@@@@&amp;,            ,****      .********,.   .*************,  ,*****,    ,** /@
@@@@@@@@@@@@&amp;/ .****,    ************.   ****************************      **. #
@@@@@@@@@@@@@, *****,    ,***********    .******,   ,****.   .*****,***,,***** ,
@@@@@@@@@@@@&amp;..**************,  ,***********************       ,*,    ********..
@@@@@@@@@@@@&amp; ,**.    ,******.  .*******.    .**********,     .**********. .**, 
@@@@@@@@@@@@% ,*       ,***************.      .*****************************,   
@@@@@@@@@@@@@&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;@,(&amp;&amp;&amp;&amp;@,(&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;#*@&amp;&amp;&amp;@*#&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;
@@@@@@@@@@@@@@@@@@@@@@@@@@@@(.#@@@@(.#@@@@@@@@@@@@@@@@@@@@@#**@@@@(.#@@@@@@@@@@@
  </span></pre>
  &nbsp;
  <a class="navbar-item" title="Go to Home" href="/">
    <div class="is-6">Blogue do Caloni</div>
  </a>
  </div>
  </div>
  </nav>
  <div class="container">
  <p class="title">
  <a class="external" href="https://www.caloni.com.br/todo-put-external-link-here">
  Todo Put Post Title Here
  </a>
  </p>
  <div class="content">
<p>Ap√≥s algumas semanas de suspense, chegamos finalmente √† nossa segunda e √∫ltima parte da saga do dicion√°rio Houaiss.</p>
<p>Como devem [estar lembrados], a primeira parte se disp√¥s a desmontar a ofusca√ß√£o usada nos arquivos do dicion√°rio para permitir nossa posterior an√°lise, com o simples e justo objetivo de import√°-lo para o Babylon, cujas funcionalidades de busca s√£o bem superiores.</p>
<p>Feito isso, agora nos resta entender a estrutura interna do Houaiss para montar um conversor que ir√° ajudar o Babylon Builder a construir nosso Houaiss-Babylon. Simples, n√£o?</p>
<p>A primeira parte de toda an√°lise √© a busca por padr√µes com um pouco de bom senso. O Houaiss armazena suas defini√ß√µes em um conjunto de arquivos de nome deahNNN.dhx (provavelmente deah de Dicionario Eletr√¥nico Ant√¥nio Houaiss). Os NNN variam de 001 -- o maior arquivo -- at√© 065, com algumas poucas lacunas, em um total de 53 arquivos originais.</p>
<p>O nosso r√∫stico importador fez o trabalho de desofuscar todos os 53 arquivos usando a mesma l√≥gica encontrada pelo WinDbg: somar o valor 0x0B para cada byte do arquivo. Dessa forma foram gerados 53 arquivos novos no mesmo diret√≥rio, por√©m com a extens√£o TXT.</p>
<p>Partindo do bom senso, abriremos o arquivo maior, deah001.txt, e abriremos o pr√≥prio dicion√°rio Houaiss, em busca de um padr√£o que fa√ßa sentido. Como poderemos ver na figura abaixo, o padr√£o inicial n√£o √© nem um pouco complicado.</p>
<p>{{< image src="houaiss-analysis.png" caption="Houaiss Analysis" >}}</p>
<p>As duas primeiras observa√ß√µes do formato do arquivo nos dizem que (1) o primeiro caractere de cada linha indica o conte√∫do dessa linha, e que (2) a formata√ß√£o dos caracteres √© feita dentro de um par de chaves {}.</p>
<p>Dessa forma, podemos come√ßar a construir nosso interpretador de arquivos do Houaiss em seu formato b√°sico.</p>
<p>    #include <iostream></p>
<p>    #include <string></p>
<p>    </p>
<p>    int main()</p>
<p>    {</p>
<p>    	char cmd; // comando da linha atualmente lida</p>
<p>    	string line; // linha atualmente lida</p>
<p>    	int count = 0; // contador de palavras</p>
<p>    </p>
<p>    	while( getline(cin, line) )</p>
<p>    	{</p>
<p>    		cmd = line[0]; // guardamos o comando</p>
<p>    		line.erase(0, 1); // tiramos o comando da linha</p>
<p>    		format(line); // formata√ß√£o da linha (explica√ß√µes adiante)</p>
<p>    </p>
<p>    		switch( cmd ) // que comando √© esse?</p>
<p>    		{</p>
<p>    		case '*': // verbete</p>
<p>    			++count;</p>
<p>    			cout << '\n' << line << '\n';</p>
<p>    			break;</p>
<p>    </p>
<p>    		case ':': // defini√ß√£o</p>
<p>    			cout << line << "<br>\n";</p>
<p>    			break;</p>
<p>    		}</p>
<p>    	}</p>
<p>    </p>
<p>    	return 0;</p>
<p>    }</p>
<p>Simples e funcional. Com esse c√≥digo j√° √© poss√≠vel extrair o b√°sico que precisamos de um dicion√°rio: os voc√°bulos e suas defini√ß√µes.</p>
<p>Para conseguir mais, √© necess√°rio mais trabalho.</p>
<p>A formata√ß√£o segue o estilo j√° identificado, de forma que podemos aos poucos montar um interpretador de formata√ß√£o para HTML, que √© o formato reconhecido pelo Babylon Builder. Podemos seguir o seguinte molde, chamado no exemplo de c√≥digo anterior:</p>
<p>    void format(string& str)</p>
<p>    {</p>
<p>    	string::size_type pos1 = 0;</p>
<p>    	string::size_type pos2 = 0;</p>
<p>    </p>
<p>    	while( (pos1 = str.find('<')) != string::npos )</p>
<p>    		str.replace(pos1, 1, "<");</p>
<p>    </p>
<p>    	while( (pos1 = str.find('>')) != string::npos )</p>
<p>    		str.replace(pos1, 1, ">");</p>
<p>    </p>
<p>    	while( (pos1 = str.find('{')) != string::npos )</p>
<p>    	{</p>
<p>    		if( pos1 && str[pos1 - 1] == '\\' ) // caractere de escape</p>
<p>    			str.replace(pos1 - 1, 2, "{");</p>
<p>    		else</p>
<p>    		{</p>
<p>    			string subStr;</p>
<p>    </p>
<p>    			pos2 = str.find('}', pos1);</p>
<p>    </p>
<p>    			if( pos2 != string::npos )</p>
<p>    				subStr = str.substr(pos1 + 1, pos2 - pos1 - 1);</p>
<p>    			else</p>
<p>    				subStr = str.substr(pos1 + 1);</p>
<p>    </p>
<p>    			istringstream is(subStr);</p>
<p>    </p>
<p>    			string fmt;</p>
<p>    			string word;</p>
<p>    			is >> fmt;</p>
<p>    			getline(is, word);</p>
<p>    			if( word[0] == ' ' )</p>
<p>    			word.erase(0, 1);</p>
<p>    </p>
<p>    			if( fmt.find("\\i") != string::npos )</p>
<p>    				word = "<i>" + word + "</i>";</p>
<p>    </p>
<p>    			if( fmt.find("\\b") != string::npos )</p>
<p>    				word = "<b>" + word + "</b>";</p>
<p>    </p>
<p>    			if( fmt.find("\\f20") != string::npos )</p>
<p>    				word = "<font style=\"text-transform: uppercase;\">" + word + "</font>";</p>
<p>    </p>
<p>    			if( fmt.find("\\super") != string::npos )</p>
<p>    				word = "<font style=\"vertical-align: super;\">" + word + "</font>";</p>
<p>    </p>
<p>    			if( pos2 != string::npos )</p>
<p>    				str.replace(pos1, pos2 - pos1 + 1, word);</p>
<p>    			else</p>
<p>    				str.replace(pos1, pos2, word);</p>
<p>    		}</p>
<p>    	}</p>
<p>    }</p>
<p>Algumas partes ainda est√£o feias, eu sei. Mas, ei, isso √© um c√≥digo de r√°quer, n√£o √© mesmo? Al√©m do mais, se isso n√£o √© desculpa suficiente, estamos trabalhando em uma vers√£o beta.</p>
<p>A partir dessas duas fun√ß√µes √© poss√≠vel dissecar o primeiro arquivo do dicion√°rio, e assim, construirmos a primeira vers√£o interessante do Houaiss no Babylon.</p>
<p>{{< image src="houaiss-babylon-installing.png" caption="Houaiss Babylon Installing" >}}</p>
<p>Como √© normal a qualquer dicion√°rio do Babylon, podemos instal√°-lo simplesmente clicando duas vezes no arquivo (em uma m√°quina com Babylon previamente instalado).</p>
<p>{{< image src="houaiss-babylon.png" caption="Houaiss Babylon" >}}</p>
<p>O projeto atual est√° um tanto capenga, mas j√° desencripta os arquivos do Houaiss e gera o projeto do Babylon Builder sozinho. Em anexo j√° est√° um projeto do Babylon Builder. Basta copiar o arquivo Houaiss.txt para a pasta do projeto e gerar o projeto do Babylon.</p>
<p>[estar lembrados]: {{< relref "conversor-de-houaiss-para-babylon-parte-1" >}}</p>

</div>
  <div class="taglist">
  <p class="author">Wanderley Caloni,
     <a href="https://github.com/Caloni/blog/blob/master/content/posts/todo-dunno-original-post-source">
     2012-02-15 00:00:00 &#43;0000
     </a>
  </p>
  <a href="/categories/writting">writting</a> 
  <a href="/tags/movies">movies</a> 
  <a class="externalgray" href="https://t.me/paneloni">discuss</a>
  <script type="text/javascript" src="//cdn.livetrafficfeed.com/static/hitcounterjs/live.js?sty=49&min=1&sta=0&uni=1&tz=America%2FSao_Paulo&ro=0"></script><noscript id="LTF_hitcounter"><a href="https://livetrafficfeed.com/hit-counter">Hit Counter</a></noscript>
  </div>
  </div>
  </body>
  </html>
