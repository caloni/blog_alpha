<!DOCTYPE html>
<html lang="en-us" dir="ltr" itemscope itemtype="http://schema.org/Article">
  <head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Blogue do Caloni - 2 Coelhos</title>
  <meta name="author" content="" />
  <meta name="generator" content="Hugo 0.110.0">
  <meta property="og:title" content="2 Coelhos"/>
  <meta property="og:type"
        content="article"/>
  <meta property="og:url" content="http://www.caloni.com.br/todo-put-original-title-slug/"/>
  <meta property="og:image"
        content="/img/author.jpg"/>
  <meta property="og:description"
        content="Uma montagem impec·vel consegue dar o tom da narrativa do complexo 2 Coelhos. AlÈm de complexo, existem pequenos detalhes da trama que forÁam um pouco a realidade (como a uni„o entre o protagonista e..."/>
  <link href="" rel="feed" type="application/rss+xml"
        title="Blogue do Caloni"/>
  <link rel="stylesheet" type="text/css" href="/css/custom.css"/>
  <link rel="stylesheet" type="text/css" href="/css/jquery-ui.css"/>
  <link rel="stylesheet" type="text/css" href="/css/board-min.css"/>
  <script src="/js/jquery-1.10.2.js"></script>
  <script src="/js/jquery-ui.js"></script>
  <script src="/js/pgnyui.js"></script>
  <script src="/js/pgnviewer.js"></script>
  <script src="/js/list.js"></script>
  <link rel="icon" href="/img/favicon.ico"/>
</head>
<body style="min-height:100vh;display:flex;flex-direction:column">
  <nav class="navbar has-shadow is-white"
        role="navigation" aria-label="main navigation">
  <div class="container">
  <div class="navbar-brand">
  <pre><span style="font-size: 3px; margin: 0; display: block;">
&amp;*/. .*%@@@@@@@@@@@@&amp;/    , &amp;@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@#,*@@@@%,*&amp;@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@./@.(@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@@@@**#./((,*, *./((*,#,&amp;@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@@@@@.#@@%&amp;@@* (@@%&amp;@@/#@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@@@@@,#@@&amp;&amp;@@, (@@&amp;&amp;@@*#@@@@@@@@@@@@@#/,,.         ..,/#&amp;@@@@@@@@@@@@@@@@@@@@@@@
@@@@@&amp;, .//      .//  .%@@@@@@&amp;#.  .,****.,*************,.  .(&amp;@@@@@@@@@@@@@@@@@
@@@*                     ,@/  .**,,,*********,   ,***,   ****    *@@@@@@@@@@@@@@
@#                         ,***      .******       ,***,*****,      *&amp;@@@@@@@@@@
&amp;                           ,**      .******.     .******************  (@@@@@@@@
                             ****..,*************************,    ,***   (@@@@@@
@@@@#,,,,,,,,,,,,,,,,,,,,*********,   ,**************,  .***,      .**. .  %@@@@
@@@@%                   .***,.,****,.,***,     ,****      ***.     ,******, /@@@
@@@@@&amp;.                ,**       *******,       *****,  .******************, *@@
@@@@@@@&amp;,            ,****      .********,.   .*************,  ,*****,    ,** /@
@@@@@@@@@@@@&amp;/ .****,    ************.   ****************************      **. #
@@@@@@@@@@@@@, *****,    ,***********    .******,   ,****.   .*****,***,,***** ,
@@@@@@@@@@@@&amp;..**************,  ,***********************       ,*,    ********..
@@@@@@@@@@@@&amp; ,**.    ,******.  .*******.    .**********,     .**********. .**, 
@@@@@@@@@@@@% ,*       ,***************.      .*****************************,   
@@@@@@@@@@@@@&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;@,(&amp;&amp;&amp;&amp;@,(&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;#*@&amp;&amp;&amp;@*#&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;
@@@@@@@@@@@@@@@@@@@@@@@@@@@@(.#@@@@(.#@@@@@@@@@@@@@@@@@@@@@#**@@@@(.#@@@@@@@@@@@
  </span></pre>
  &nbsp;
  <a class="navbar-item" title="Go to Home" href="/">
    <div class="is-6">Blogue do Caloni</div>
  </a>
  </div>
  </div>
  </nav>
  <div class="container">
  <p class="title">
  <a class="external" href="https://www.caloni.com.br/todo-put-external-link-here">
  Todo Put Post Title Here
  </a>
  </p>
  <div class="content">
<p>J√° foi escrito muita coisa sobre os pr√≥s e contras da nota√ß√£o h√∫ngara. J√° o typedef arcaico, esse pedacinho imprest√°vel de c√≥digo, ficou esquecido, e hoje em dia traz mais d√∫vidas na cabe√ßa dos principiantes em C++ do que deveria. Para tentar desobscurecer os mitos e fatos, vamos tentar explicar o que significa essa constru√ß√£o t√£o at√≠pica, mas comum no dia-a-dia.</p>
<p>Vejamos um exemplo t√≠pico desse pequeno Frankenstein sem√¢ntico:</p>
<p>Bom, eu nem sei por onde come√ßar. Talvez pelo conceito de typedef.</p>
<p>#### Typedefs</p>
<p>Um typedef, basicamente, √© um apelido. Voc√™ informa um tipo e define "outro tipo".</p>
<p>Se, futuramente, eu sair da empresa e entrar outro "Wanderley alguma-coisa", ser√° poss√≠vel usar o apelido novamente, bastando alterar o typedef:</p>
<p>_Bom, "outro tipo" √© forma de dizer. Isso √© uma descri√ß√£o err√¥nea em muitos livros. De fato, o compilador enxerga **o mesmo tipo com outro nome**, da√≠ chamarmos o typedef de apelido, mesmo._</p>
<p>```</p>
<p>/** @file dois_apelidos.cpp */</p>
<p>#include <iostream></p>
<p>using namespace std;</p>
<p>struct Struct</p>
<p>typedef Struct Struct1;</p>
<p>typedef Struct Struct2;</p>
<p>int main()</p>
<p>```</p>
<p>struct Struct struct Struct</p>
<p>#### Granularidade dos tipos</p>
<p>Tipos simples s√£o f√°ceis de entender porque possuem seus s√≠mbolos no mesmo lugar:</p>
<p>J√° os tipos um pouco mais complicados permite alguma mudan√ßa aqui e acol√°:</p>
<p>Essa liberdade da linguagem, mesmo sendo um recurso √∫til, pode ser bem nocivo dependendo de quem olha o c√≥digo:</p>
<p>Em algumas formas da sintaxe, al√©m de ser inevit√°vel, gera bastante desconfian√ßa:</p>
<p>```</p>
<p>#include <iostream></p>
<p>void func(int x, int y)</p>
<p>int main()</p>
<p>```</p>
<p>#### Structs em C++</p>
<p>Antigamente, as structs eram constru√ß√µes em C que definiam **um agregado de tipos primitivos** (ou outras structs) e que poderiam gerar vari√°veis desse tipo em qualquer lugar, desde que informado seu nome e que se tratasse de uma struct:</p>
<p>```</p>
<p>/** @file structs.cpp */</p>
<p>struct MyStruct { int x, y; };</p>
<p>void func1()</p>
<p>void func2(struct MyStruct msa)</p>
<p>int main()</p>
<p>```</p>
<p>Para evitar toda essa digita√ß√£o, os programadores usavam um pequeno truque criando um apelido para a estrutura, e usavam o apelido no lugar da struct (apesar de ambas representarem a mesma coisa).</p>
<p>Com a defini√ß√£o da linguagem C++ padr√£o, e mais moderna, essa antiguidade foi removida, apesar de ainda suportada. Era poss√≠vel usar apenas o nome do struct como seu tipo:</p>
<p>```</p>
<p>/** @file structs.cpp */</p>
<p>struct MyStruct { int x, y; };</p>
<p>void func1()</p>
<p>void func2(/*struct*/ MyStruct msa)</p>
<p>int main()</p>
<p>```</p>
<p>Por√©m, isso vai um pouco al√©m de quando a Microsoft come√ßou a fazer c√≥digo para seu sistema operacional. Naquela √©poca, o padr√£o ainda estava se formando e existia mais ou menos um consenso de como seria a linguagem C++ (sem muitas altera√ß√µes do que de fato a linguagem C j√° era). De qualquer forma, a linguagem C imperava bem mais que C++. Dessa forma, j√° era bem formada a ideia de como declarar uma struct: a forma antiga.</p>
<p>Al√©m do uso controverso do** _sublinhado** para nomear entidades (que no padr√£o foi recomendado que se reservasse aos nomes internos da biblioteca-padr√£o) e do uso de **MA√çUSCULAS_NO_NOME** (historicamente atribu√≠do a nomes definidos no pr√©-processador), o uso do typedef atracado a um struct era muito difundido. E ficou ainda mais depois que a API do Windows foi publicada com essas defini√ß√µes.</p>
<p>#### Como fazer,ent√£o?</p>
<p>Ora, do mesmo jeito que √© feito h√° vinte anos: sem typedefs. O pr√≥prio paradigma da linguagem, independente de padr√µes de APIs, de sistemas operacionais ou de projetos espec√≠ficos j√° orienta o programador para entender o que o espera na leitura de um c√≥digo-fonte qualquer. Qualquer pessoa que aprendeu o b√°sico do b√°sico sobre ponteiros e structs consegue ler o c√≥digo abaixo:</p>
<p>```</p>
<p>// Papai, o que que √© isso?</p>
<p>// Ora, filho, apenas uma defini√ß√£o de estrutura!</p>
<p>struct MinhaStruct {</p>
<p>// muitas linhas abaixo...</p>
<p>void func(MinhaStruct* ms)</p>
<p>int main()</p>
<p>```</p>
<p>Agora, para entender a forma antiga, ou voc√™ se baseou no copy&paste dos modelos Microsoftianos, ou seja, decoreba, ou voc√™ √© PhD em Linguagem C/C++ e padr√µes hist√≥ricos de linguagens legadas. Se n√£o √©, deveria come√ßar o curso agora.</p>
<p>```</p>
<p>// Papai, o que que √© isso?</p>
<p>// Ora, filho, apenas uma defini√ß√£o de sin√¥nimo da struct</p>
<p>// _MINHASTRUCT, cujo nome n√£o √© usado, para dois nomes</p>
<p>// em mai√∫sculas, apesar se n√£o serem defines, com uma</p>
<p>// nomenclatura de ponteiro que eu nunca vi na vida (obs: </p>
<p>// papai programa em um sistema n√£o-Windows).</p>
<p>typedef struct _MINHASTRUCT {</p>
<p>MINHASTRUCT, *LPMINHASTRUCT;</p>
<p>// muitas linhas abaixo...</p>
<p>void func(LPMINHASTRUCT ms)</p>
<p>int main()</p>
<p>```</p>
<p>{{< image src="gFNalqB.png" caption="C√≥digo Antes x Depois no Visual Studio" >}}</p>
<p>Da mesma forma, o uso de uma estrutura simples de tipos mant√©m a lista de nomes do seu projeto limpa e clara. Compare o visualizador de classes em projetos Windows com algo mais C++ para ter uma ideia.</p>
<p>√â claro, essa √© apenas uma sugest√£o. Existem vantagens em sua utiliza√ß√£o. Existe alguma vantagem no modo antigo? Existe: a Microsoft usa, e talvez mais pessoas usem. Basta a voc√™ decidir qual deve ser o melhor caminho.</p>
<p>#### Atualiza√ß√£o</p>
<p>De acordo com o leitor¬† [Adriano dos Santos Fernandes](http://www.caloni.com.br/blog/typedef-arcaico#comment-17016), a obrigatoriedade do nome struct ap√≥s seu nome continua valendo para a linguagem C padr√£o, assim como no compilador GCC ocorre um erro ao tentar omiti-la. Apenas na linguagem C++ essa obrigatoriedade n√£o existe mais.</p>
<p>Eu n√£o fiz meus testes, mas confio no diagn√≥stico de nosso amigo. A maior falha do artigo, no entanto, √© usar a linguagem C como base, quando na verdade ele deveria falar sobre o uso desses typedefs em C++. Esse erro tamb√©m foi corrigido no original.</p>
</div>
  <div class="taglist">
  <p class="author">Wanderley Caloni,
     <a href="https://github.com/Caloni/blog/blob/master/content/posts/todo-dunno-original-post-source">
     2012-02-15 00:00:00 &#43;0000
     </a>
  </p>
  <a href="/categories/writting">writting</a> 
  <a href="/tags/movies">movies</a> 
  <a class="externalgray" href="https://t.me/paneloni">discuss</a>
  <script type="text/javascript" src="//cdn.livetrafficfeed.com/static/hitcounterjs/live.js?sty=49&min=1&sta=0&uni=1&tz=America%2FSao_Paulo&ro=0"></script><noscript id="LTF_hitcounter"><a href="https://livetrafficfeed.com/hit-counter">Hit Counter</a></noscript>
  </div>
  </div>
  </body>
  </html>
